# Загадочный магазин

|   Cобытие   | Название | Категория | Сложность |
| :---------: | :------: | :-------: | :-------: |
| Student CTF 2024 |  Загадочный магазин  |  Web  |  Easy  |

## Описание

>В моём чудесном магазине можно купить абсолютно всё, даже приподнятое осеннее настроение! Чуть не забыл, сегодня всем студентам скидка.

## Решение

>Читаем выданные сорцы, сразу видим в коде database.go захардкоженный купон со значением ```StuD3n7_d1sC0uNt``` который должен давать скидку в 10%.
>Внимательно смотрим handlers.go и обращаем внимание на то, как вычисляется скидка.
>Замечаем, что в хэндлере не проверяется, достаточно ли средств на счете пользователя для применения купона.
>checkoutHandler при расчете общего количества средств, удерживаемых от пользователя, учитывает скидку. Однако потенциально скидка может быть больше, чем итоговая сумма.
>Итого, чтобы набить необходимый баланс для покупки флага, нам достаточно всего лишь закинуть в корзину товаров на большую сумму,
>применить купон, найденный в database.go, удалить все товары из корзины и сделать checkout, тогда наш баланс возрастёт на сумму рассчитанной скидки (10% от общей суммы товаров в корзине).

### Флаг

```
stctf{br0k3N_l0g1c_BuT_yuMmY_DuMpl1ngS_Fr0m_SPb}
```
